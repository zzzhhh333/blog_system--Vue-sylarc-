{"version":3,"file":"roving-focus-item.js","sources":["../../../../../../packages/components/roving-focus-group/src/roving-focus-item.vue"],"sourcesContent":["<template>\n  <el-roving-focus-collection-item\n    :id=\"id\"\n    :focusable=\"focusable\"\n    :active=\"active\"\n  >\n    <slot />\n  </el-roving-focus-collection-item>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, inject, provide, ref, unref } from 'vue'\nimport { useId } from '@element-plus/hooks'\nimport { composeEventHandlers, getEventCode } from '@element-plus/utils'\nimport { EVENT_CODE } from '@element-plus/constants'\nimport { ElCollectionItem as ElRovingFocusCollectionItem } from './roving-focus-group'\nimport {\n  ROVING_FOCUS_GROUP_INJECTION_KEY,\n  ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,\n} from './tokens'\n\nexport default defineComponent({\n  components: {\n    ElRovingFocusCollectionItem,\n  },\n  props: {\n    focusable: {\n      type: Boolean,\n      default: true,\n    },\n    active: Boolean,\n  },\n  emits: ['mousedown', 'focus', 'keydown'],\n  setup(props, { emit }) {\n    const { currentTabbedId, onItemFocus, onItemShiftTab, onKeydown } = inject(\n      ROVING_FOCUS_GROUP_INJECTION_KEY,\n      undefined\n    )!\n\n    const id = useId()\n    const rovingFocusGroupItemRef = ref<HTMLElement>()\n\n    const handleMousedown = composeEventHandlers(\n      (e: Event) => {\n        emit('mousedown', e)\n      },\n      (e) => {\n        if (!props.focusable) {\n          e.preventDefault()\n        } else {\n          onItemFocus(unref(id))\n        }\n      }\n    )\n\n    const handleFocus = composeEventHandlers(\n      (e: Event) => {\n        emit('focus', e)\n      },\n      () => {\n        onItemFocus(unref(id))\n      }\n    )\n\n    const handleKeydown = composeEventHandlers(\n      (e: Event) => {\n        emit('keydown', e)\n      },\n      (e) => {\n        const { shiftKey, target, currentTarget } = e as KeyboardEvent\n        const code = getEventCode(e as KeyboardEvent)\n\n        if (code === EVENT_CODE.tab && shiftKey) {\n          onItemShiftTab()\n          return\n        }\n        if (target !== currentTarget) return\n        onKeydown(e as KeyboardEvent)\n      }\n    )\n\n    const isCurrentTab = computed(() => currentTabbedId.value === unref(id))\n\n    provide(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY, {\n      rovingFocusGroupItemRef,\n      tabIndex: computed(() => (unref(isCurrentTab) ? 0 : -1)),\n      handleMousedown,\n      handleFocus,\n      handleKeydown,\n    })\n\n    return {\n      id,\n      handleKeydown,\n      handleFocus,\n      handleMousedown,\n    }\n  },\n})\n</script>\n"],"names":["defineComponent","ElRovingFocusCollectionItem","inject","ROVING_FOCUS_GROUP_INJECTION_KEY","useId","ref","composeEventHandlers","unref","getEventCode","EVENT_CODE","computed","provide","ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY","_resolveComponent","_openBlock","_createBlock","_withCtx","_renderSlot","_export_sfc"],"mappings":"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"}